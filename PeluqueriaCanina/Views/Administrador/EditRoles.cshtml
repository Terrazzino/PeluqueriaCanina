@model PeluqueriaCanina.Models.Users.Persona

@{
    ViewData["Title"] = "Editar Roles";
    var gruposDisponibles = ViewBag.GruposDisponibles as List<PeluqueriaCanina.Models.Grupos.Grupo>;
}

<div class="overlay-dark p-4">
    <div class="container d-flex justify-content-center">

        <!-- Card principal centrada -->
        <div class="card card-custom text-light shadow-lg rounded-4 p-4 w-100" style="max-width: 700px;">

            <!-- Encabezado -->
            <div class="d-flex justify-content-between align-items-center flex-wrap mb-4">
                <h2 class="text-light fw-bold mb-1 text-center w-100">
                    Editar Roles de @Model.Nombre @Model.Apellido
                </h2>

                <div class="d-flex justify-content-center mt-2 w-100">
                    <a asp-controller="Administrador" asp-action="Dashboard"
                       class="btn btn-outline-light btn-rounded shadow-sm">
                        Volver al Inicio
                    </a>
                </div>
            </div>

            <!-- Grupos asignados -->
            <h4 class="mt-3 fw-semibold">Grupos Asignados</h4>

            <ul class="list-group mb-4 mt-2">
                @foreach (var g in Model.Grupos)
                {
                    <li class="list-group-item d-flex justify-content-between align-items-center text-light">
                        <span class="fw-semibold">@g.Nombre</span>

                        <form asp-action="QuitarGrupo" method="post" class="m-0">
                            <input type="hidden" name="usuarioId" value="@Model.Id" />
                            <input type="hidden" name="grupoId" value="@g.Id" />
                            <button type="submit" class="btn btn-danger btn-sm btn-rounded shadow-sm">
                                Quitar
                            </button>
                        </form>
                    </li>
                }
            </ul>

            <!-- Agregar grupo -->
            <h4 class="mt-4 fw-semibold">Agregar Grupo</h4>

            <form asp-action="AgregarGrupo" method="post"
                  class="d-flex gap-3 align-items-center mt-2 justify-content-center">

                <input type="hidden" name="usuarioId" value="@Model.Id" />

                <select name="grupoId" class="form-select w-50">
                    <option value="">-- Seleccionar grupo --</option>

                    @if (gruposDisponibles != null)
                    {
                        foreach (var g in gruposDisponibles)
                        {
                            if (!Model.Grupos.Any(x => x.Id == g.Id))
                            {
                                <option value="@g.Id">@g.Nombre</option>
                            }
                        }
                    }
                </select>

                <button type="submit" class="btn btn-success btn-rounded shadow-sm px-4">
                    Agregar
                </button>
            </form>

        </div>

    </div>
</div>
