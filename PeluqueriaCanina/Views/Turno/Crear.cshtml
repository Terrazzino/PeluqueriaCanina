@{
    ViewData["Title"] = "Reservar Turno";
    Layout = "_Layout";
}

<div class="container mt-4">
    <h2>Reservar Turno</h2>

    <form method="post" asp-action="Crear">
        <div class="row mb-3">
            <div class="col-md-4">
                <label>Mascota</label>
                <select class="form-select" name="MascotaId" required>
                    <option value="">Seleccione una mascota</option>
                    @foreach (var m in ViewBag.Mascotas as List<PeluqueriaCanina.Models.ClasesDeCliente.Mascota>)
                    {
                        <option value="@m.Id">@m.Nombre</option>
                    }
                </select>
            </div>
            <div class="col-md-4">
                <label>Servicio</label>
                <select class="form-select" name="ServicioId" required>
                    <option value="">Seleccione un servicio</option>
                    @foreach (var s in ViewBag.Servicios as List<PeluqueriaCanina.Models.ClasesDeAdministrador.Servicio>)
                    {
                        <option value="@s.Id">@s.NombreDelServicio (@s.Duracion.TotalMinutes min)</option>
                    }
                </select>
            </div>
            <div class="col-md-4">
                <label>Peluquero (opcional)</label>
                <select class="form-select" name="PeluqueroId">
                    <option value="">Me da lo mismo</option>
                    @foreach (var p in ViewBag.Peluqueros as List<PeluqueriaCanina.Models.Users.Peluquero>)
                    {
                        <option value="@p.Id">@p.Nombre @p.Apellido</option>
                    }
                </select>
            </div>
        </div>

        <div id="calendar"></div>

        <button type="submit" class="btn btn-success mt-3">Reservar Turno</button>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'timeGridWeek',
            slotDuration: '00:30:00',
            allDaySlot: false,
            nowIndicator: true,
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'timeGridWeek'
            },
            businessHours: true,
            events: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(ViewBag.Eventos)),
            eventDisplay: 'block',
            eventTextColor: 'black',
        });

        calendar.render();
    });
</script>
